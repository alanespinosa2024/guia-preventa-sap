<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gu√≠a de Preventa SAP by Alan Espinosa</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>

body { font-family: Arial, sans-serif; background: #f5f5f5; margin:0; padding:0; color:#333; }
header { background: #004d99; color: #fff; padding: 25px 20px; text-align:center; }
h1 { margin:0; font-size:2em; }
.container { padding: 20px; max-width: 900px; margin:auto; }
.accordion { cursor:pointer; padding:15px; width:100%; border:none; text-align:left; outline:none; margin-bottom:5px; font-size:1.1em; border-radius:5px; display:flex; align-items:center; }
.accordion span { margin-right:10px; font-size:1.2em; }
.panel { padding: 0 20px 15px 20px; background:white; display:none; overflow:hidden; border-left:5px solid; margin-bottom:10px; border-radius:5px; }
.phase-blue { background-color:#0073e6; color:white; }
.phase-green { background-color:#28a745; color:white; }
.phase-orange { background-color:#ff9933; color:white; }
.phase-purple { background-color:#6f42c1; color:white; }
input[type=text], input[type=number], textarea { width: 95%; padding:6px; border:1px solid #ccc; border-radius:4px; margin-top:5px; }
textarea { resize: vertical; }
button { margin-top: 15px; padding: 10px 20px; background-color: #2980b9; color: white; border: none; border-radius: 5px; cursor: pointer; }
button:hover { background-color: #1c5980; }
#resumen { background:white; padding:20px; border-radius:5px; border-left:5px solid #004d99; margin-top:20px; }
table { border-collapse: collapse; width: 100%; margin-top:10px; }
table, th, td { border:1px solid #ccc; }
th, td { padding:8px; text-align:left; }
th { background:#f0f0f0; }
.semaforo { font-weight:bold; padding:3px 8px; border-radius:4px; color:white; display:inline-block; }
.semaforo-verde { background:#28a745; }
.semaforo-amarillo { background:#ffc107; color:#333; }
.semaforo-rojo { background:#dc3545; }
.bar { height:20px; border-radius:4px; display:inline-block; background:#28a745; }
</style>
</head>
<body>

<header>
<h1>Gu√≠a de Preventa SAP - Alan Espinosa</h1>
</header>

<div class="container">

<!-- Gu√≠a Maestra de Preventa -->
<button class="accordion phase-blue">
  <span>‚û§</span> Gu√≠a Maestra de Preventa: Estrategia de Valor S/4HANA
</button>
<div class="panel">

  <h3>I. Mentalidad Estrat√©gica (The Pitch)</h3>
  <p>
    Como preventa, <strong>no vendes licencias</strong>; vendes
    <strong>tiempo, agilidad y visibilidad</strong>.
    Tu discurso debe posicionar a SAP S/4HANA como un
    <strong>acelerador del negocio</strong>, no como un proyecto de IT.
  </p>
  <ul>
    <li><strong>Habla Negocio:</strong> ‚ÄúM√≥dulo‚Äù ‚Üí Capacidad | ‚ÄúTransacci√≥n‚Äù ‚Üí Valor</li>
    <li><strong>Mata el Excel:</strong> dato muerto vs dato vivo en tiempo real</li>
    <li><strong>Clean Core:</strong> la √∫ltima gran migraci√≥n de la empresa</li>
  </ul>

  <h3>II. Gu√≠a de Reuni√≥n: Del Dolor al Valor</h3>

  <h4>Fase 1: Apertura y Empat√≠a (Contexto)</h4>
  <p><strong>Objetivo:</strong> Establecer autoridad sin tecnicismos.</p>
  <p>
    ‚ÄúHoy las empresas no compiten solo por la calidad de su producto,
    sino por su <strong>velocidad de respuesta</strong>.
    La tecnolog√≠a debe ser el acelerador, no el freno‚Äù.
  </p>
  <p><strong>Pregunta de Oro:</strong><br>
    ‚ÄúSi hoy ocurriera un cambio dr√°stico en costos o demanda,
    ¬øcu√°nto tiempo tardan en tener el impacto real para decidir?‚Äù
  </p>

  <h4>Fase 2: Diagn√≥stico de Silos (Dolor)</h4>
  <p>
    ‚ÄúVentas promete, Almac√©n corre y Finanzas concilia.
    Esto genera <em>puntos ciegos</em> donde se pierde dinero‚Äù.
  </p>
  <p><strong>Pregunta de Impacto:</strong><br>
    ‚Äú¬øCu√°ntas versiones de ‚Äòla verdad‚Äô tienen hoy en sus juntas?‚Äù
  </p>

  <h4>Fase 3: Propuesta de Valor por √Åreas</h4>
  <table>
    <tr><th>√Årea / Proceso</th><th>Argumento de Negocio (Valor)</th></tr>
    <tr>
      <td>Finanzas (Record-to-Report)</td>
      <td>Cierre continuo y rol financiero estrat√©gico</td>
    </tr>
    <tr>
      <td>Ventas / eCommerce (Lead-to-Cash)</td>
      <td>Promesas reales y protecci√≥n del flujo de caja</td>
    </tr>
    <tr>
      <td>Compras (Source-to-Pay)</td>
      <td>Control total del gasto y pagos correctos</td>
    </tr>
    <tr>
      <td>Cadena de Suministro (Design-to-Operate)</td>
      <td>Replanificaci√≥n autom√°tica ante fallas</td>
    </tr>
    <tr>
      <td>RRHH (Recruit-to-Retire)</td>
      <td>Capital humano conectado a rentabilidad</td>
    </tr>
  </table>

  <h4>Fase 4: Momento ‚ÄúWow‚Äù (Experiencia)</h4>
  <p>
    ‚ÄúEste tablero es para el negocio, no para sistemas.
    Indicadores en tiempo real accesibles desde cualquier dispositivo‚Äù.
  </p>

  <h4>Fase 5: Diferenciador Tecnol√≥gico</h4>
  <ul>
    <li><strong>Clean Core:</strong> actualizaciones continuas sin proyectos traum√°ticos</li>
    <li><strong>SAP Signavio:</strong> mejora basada en miner√≠a real de procesos</li>
  </ul>

  <h4>Fase 6: Cierre y Visi√≥n</h4>
  <p>
    ‚ÄúSAP S/4HANA no reemplaza lo que funciona,
    <strong>desbloquea el potencial</strong> que hoy limita el crecimiento‚Äù.
  </p>

  <h3>III. ¬øQu√© Incluye RISE with SAP?</h3>
  <table>
    <tr><th>Categor√≠a</th><th>Incluido</th><th>No Incluido</th></tr>
    <tr>
      <td>N√∫cleo ERP</td>
      <td>S/4HANA Cloud (Public / Private)</td>
      <td>Industria profunda</td>
    </tr>
    <tr>
      <td>Infraestructura</td>
      <td>Hosting, backups y ciberseguridad</td>
      <td>Apps no SAP</td>
    </tr>
    <tr>
      <td>Plataforma BTP</td>
      <td>Cr√©ditos de integraci√≥n</td>
      <td>Consumo excedente</td>
    </tr>
    <tr>
      <td>Automatizaci√≥n</td>
      <td>SAP Build base</td>
      <td>Bots adicionales</td>
    </tr>
    <tr>
      <td>RRHH</td>
      <td>Administraci√≥n b√°sica</td>
      <td>SuccessFactors</td>
    </tr>
  </table>

  <h3>IV. Tips para tu Rol en la Consultora</h3>
  <ul>
    <li><strong>Gobierno:</strong> Transparencia y control presupuestal</li>
    <li><strong>eCommerce:</strong> Omnicanalidad y promesas reales</li>
    <li><strong>Industria nueva:</strong> procesos que a√∫n viven en Excel</li>
  </ul>

  <h3>V. Versiones de SAP S/4HANA</h3>

  <h4>1. SAP S/4HANA Cloud Public Edition</h4>
  <ul>
    <li><strong>Versi√≥n m√°s reciente:</strong> 2602 (febrero 2026)</li>
    <li><strong>Nomenclatura:</strong> Los dos primeros d√≠gitos indican el a√±o (26) y los dos siguientes el mes (02).</li>
    <li><strong>Novedades:</strong> Mejoras en la barra de shell con el nombre del producto visible por defecto y mayores capacidades de IA generativa mediante <em>SAP Joule</em>.</li>
  </ul>

  <h4>2. SAP S/4HANA Cloud Private Edition / On-Premise</h4>
  <ul>
    <li><strong>Versi√≥n mayor reciente:</strong> SAP S/4HANA 2025 (octubre 2025)</li>
    <li><strong>Cambio de Estrategia:</strong> Ciclo de lanzamiento cada dos a√±os a partir de 2023 para mayor estabilidad.</li>
    <li><strong>Mantenimiento:</strong> Periodo principal de 7 a√±os (mainstream).</li>
    <li><strong>Innovaciones 2025:</strong> Automatizaci√≥n inteligente, SAP Fiori 4.0 con dise√±o m√≥vil, anal√≠tica predictiva embebida en core financiero y cadena de suministro.</li>
  </ul>

  <h4>Resumen de Versiones Actuales</h4>
  <ul>
    <li><strong>Public Cloud:</strong> 2602 (Feb 2026)</li>
    <li><strong>Private Cloud / On-Premise:</strong> 2025 (Oct 2025)</li>
  </ul>

</div>


  <!-- Informaci√≥n del Cliente -->
<button class="accordion phase-blue exportable">
  <span>‚û§</span> Informaci√≥n del Cliente
</button>

<div class="panel exportable-panel">
  <label>Nombre del Cliente:<br>
    <input type="text" id="cliente" placeholder="Ej: ACME Corp.">
  </label>

  <label>Contacto:<br>
    <input type="text" id="contacto" placeholder="Ej: Juan P√©rez">
  </label>

  <label>Observaciones:<br>
    <textarea id="observaciones" placeholder="Notas adicionales..."></textarea>
  </label>

  <label>Fecha:<br>
    <input type="text" id="fecha" value="" readonly>
  </label>

  <label>Elaborado por:<br>
    <input type="text" id="elaborador" placeholder="Tu nombre aqu√≠">
  </label>
</div>



  <!-- üîπ Perfil del Prospecto (DDA Mandatory) -->
<button class="accordion phase-blue exportable">
  <span>‚û§</span> Perfil del Prospecto (Requisitos DDA)
</button>

<div class="panel exportable-panel">

  <h3 style="margin-top:10px;">Perfil del Prospecto (Requisitos DDA)</h3>

  <div class="pdf-grid">
    <label>Sector Industrial Principal:<br>
      <select id="sector">
        <option value="">Seleccione una industria...</option>
        <option value="consumer">Consumer Products</option>
        <option value="retail">Retail</option>
        <option value="public">Public Sector (Gobierno)</option>
        <option value="discrete">Discrete Manufacturing</option>
        <option value="professional">Professional Services</option>
        <option value="other">Otra Industria...</option>
      </select>
    </label>

    <label>Ingresos Anuales Estimados (USD):<br>
      <select id="revenue">
        <option value="smb">< $250M (Small/Midsize)</option>
        <option value="mid">$250M - $1B (Midmarket)</option>
        <option value="large">> $1B (Enterprise)</option>
      </select>
    </label>
  </div>

  <label class="pdf-block">Pa√≠ses de Implementaci√≥n (Localizaci√≥n):<br>
    <input type="text" id="paises" placeholder="Ej: M√©xico, Colombia, USA">
  </label>

  <label class="pdf-block">Entorno de Nube Sugerido:<br>
    <input type="radio" name="cloud_type" value="public"> S/4HANA Public Cloud (Estandarizado)<br>
    <input type="radio" name="cloud_type" value="private"> S/4HANA Private Cloud (Flexible / Custom)
  </label>

</div>


<!-- Identificaci√≥n de necesidades -->
<button class="accordion phase-green exportable">
  <span>‚û§</span> Identificaci√≥n de necesidades
</button>

<div class="panel exportable-panel">

  <label class="pdf-block">¬øCu√°ntos usuarios de sistemas/ERP son actualmente?<br>
    <small>Ej: 100</small><br>
    <input type="number" id="usuarios_totales" min="0" value="0">
  </label>

  <label class="pdf-block">¬øCu√°l es la necesidad de negocio que impulsa la transformaci√≥n?<br>
    <small>Ej: Modernizar ERP, mejorar procesos financieros, reducir TCO</small><br>
    <input type="text" id="necesidad">
  </label>

  <label class="pdf-block">¬øQu√© objetivos estrat√©gicos se esperan cumplir con S/4HANA?<br>
    <small>Ej: Transformaci√≥n digital, eficiencia operativa, crecimiento</small><br>
    <input type="text" id="objetivos">
  </label>

</div>


  <!-- üîπ Diagn√≥stico de Gaps y Necesidades T√©cnicas INTEGRADO -->
<button class="accordion phase-green exportable">
  <span>‚û§</span> Diagn√≥stico de Gaps y Necesidades T√©cnicas
</button>

<div class="panel exportable-panel">

  <h3 class="pdf-block" style="margin-top:20px;">Diagn√≥stico de Gaps y Necesidades T√©cnicas</h3>

  <h4 class="pdf-block">An√°lisis de Integraciones y Extensibilidad</h4>
  <label class="pdf-block"><strong>1. Integraci√≥n con Sistemas Legados/Externos:</strong><br>
    <small>¬øNecesita conectar SAP con otras plataformas? (Ej: Salesforce, Shopify, Software de B√°sculas)</small><br>
    <textarea id="integraciones" placeholder="Especifique el nombre del sistema y el flujo (ej: Pedidos desde Magento a SAP)..."></textarea>
  </label>

  <label class="pdf-block"><strong> 2. Requerimientos Legales o Fiscales Especiales:</strong><br>
    <small>¬øExisten normativas locales o gubernamentales no cubiertas por la ley est√°ndar?</small><br>
    <textarea id="fiscal" placeholder="Ej: Reportes espec√≠ficos para entes reguladores de gobierno..."></textarea>
  </label>

  <label class="pdf-block"><strong> 3. Definici√≥n de C√≥digo Fuente (ABAP):</strong><br>
    <small>¬øEl cliente requiere modificar el c√≥digo interno de SAP o acceso total a la SPRO?</small><br>
    <select id="abap_req" style="width: 100%; padding:6px; border-radius:4px; margin-top:5px;">
      <option value="no">No (Podemos vivir con el Est√°ndar / Clean Core)</option>
      <option value="keyuser">Solo ajustes menores (Campos nuevos / L√≥gica simple)</option>
      <option value="yes">S√ç (Necesitamos acceso total al c√≥digo fuente / Private Cloud)</option>
    </select>
  </label>

  <label class="pdf-block"><strong>4. Volumen de Operaci√≥n Mensual:</strong><br>
    <input type="number" id="vol_facturas" placeholder="Ej: N√∫mero de facturas o pedidos por mes">
  </label>

</div>

<!-- Exploraci√≥n de capacidades de SAP -->
<button class="accordion phase-orange exportable">
  <span>‚û§</span> Exploraci√≥n de capacidades de SAP
</button>

<div class="panel exportable-panel">

  <p class="pdf-block">
    <strong>Exploraci√≥n unificada de capacidades SAP S/4HANA por Categor√≠a y M√≥dulo</strong>
  </p>

  <table class="pdf-block" border="1" cellspacing="0" cellpadding="5"
         style="border-collapse: collapse; width: 100%;">
    <thead>
      <tr>
        <th>Categor√≠a</th>
        <th>M√≥dulo SAP</th>
        <th>Capacidades Incluidas (Core)</th>
        <th>Capacidades Avanzadas / CPEA</th>
        <th>Public & Grow</th>
        <th>Private</th>
      </tr>
    </thead>
    <tbody>

      <!-- FINANZAS -->
      <tr>
        <td rowspan="2"><strong>Finanzas</strong></td>
        <td><strong>SAP FI</strong></td>
        <td>
          Contabilidad General (GL), CxC, CxP, Contabilidad Bancaria,
          Activos Fijos, reportes financieros.
        </td>
        <td>
          Treasury, Advanced Cash Management, Central Finance,
          Advanced Financial Close.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>
      <tr>
        <td><strong>SAP CO</strong></td>
        <td>
          Control de costes, centros de costo y beneficio,
          contabilidad interna, costos de producto.
        </td>
        <td>
          An√°lisis avanzado de rentabilidad, simulaciones,
          planificaci√≥n financiera extendida (FP&A).
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>

      <!-- LOG√çSTICA -->
      <tr>
        <td rowspan="5"><strong>Log√≠stica y Cadena de Suministro</strong></td>
        <td><strong>SAP MM</strong></td>
        <td>
          Compras, gesti√≥n de proveedores, inventarios,
          planificaci√≥n b√°sica de materiales (MRP).
        </td>
        <td>
          Demand Planning avanzado, integraci√≥n extendida con proveedores.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>
      <tr>
        <td><strong>SAP SD</strong></td>
        <td>
          √ìrdenes de venta, precios, entregas, facturaci√≥n,
          ciclo Order-to-Cash.
        </td>
        <td>
          Pricing avanzado, ATP avanzado, integraci√≥n omnicanal.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>
      <tr>
        <td><strong>SAP PP</strong></td>
        <td>
          Planificaci√≥n y control de producci√≥n,
          √≥rdenes de fabricaci√≥n, MRP.
        </td>
        <td>
          Manufacturing Execution,
          planificaci√≥n avanzada de capacidad.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>
      <tr>
        <td><strong>SAP QM</strong></td>
        <td>
          Inspecciones de calidad en compras,
          producci√≥n y entregas.
        </td>
        <td>
          Quality Management avanzado,
          anal√≠tica de calidad.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>
      <tr>
        <td><strong>SAP PM</strong></td>
        <td>
          Mantenimiento preventivo y correctivo,
          gesti√≥n de activos e instalaciones.
        </td>
        <td>
          Asset Management avanzado,
          mantenimiento predictivo.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>

      <!-- RECURSOS HUMANOS -->
      <tr>
        <td><strong>Recursos Humanos</strong></td>
        <td><strong>SAP HCM</strong></td>
        <td>
          Administraci√≥n de personal, tiempos,
          estructura organizativa b√°sica.
        </td>
        <td>
          SuccessFactors: Payroll, Recruiting,
          Learning, Performance.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>

      <!-- PROYECTOS -->
      <tr>
        <td><strong>Gesti√≥n de Proyectos</strong></td>
        <td><strong>SAP PS</strong></td>
        <td>
          Planificaci√≥n y control de proyectos,
          costos, tiempos y presupuestos.
        </td>
        <td>
          Integraci√≥n avanzada con PP, CO y anal√≠tica extendida.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>

      <!-- PLATAFORMA -->
      <tr>
        <td><strong>Plataforma y Anal√≠tica</strong></td>
        <td><strong>S/4HANA & BTP</strong></td>
        <td>
          Embedded Analytics, Fiori UX,
          Machine Learning b√°sico.
        </td>
        <td>
          SAP BTP, SAP Analytics Cloud,
          Integration Suite, Extensions.
        </td>
        <td><input type="checkbox"></td>
        <td><input type="checkbox"></td>
      </tr>

    </tbody>
  </table>

  <p class="pdf-block" style="margin-top:15px; font-style:italic; font-size:0.9em;">
    <strong>Nota:</strong> En SAP S/4HANA muchas capacidades est√°n integradas de forma nativa
    (por ejemplo FI + CO), reduciendo complejidad frente a SAP ECC.
  </p>

</div>


<!-- Readiness y Alineaci√≥n -->
<button class="accordion phase-purple exportable">
  <span>‚û§</span> Readiness y Alineaci√≥n
</button>

<div class="panel exportable-panel">
  <label class="pdf-block">Evaluar preparaci√≥n organizacional:<br>
    <small>Ej: Alineaci√≥n de stakeholders, equipo interno identificado, patrocinio ejecutivo confirmado</small><br>
    <input type="text" id="readiness">
  </label>
</div>


<!-- Introducci√≥n SAP FUE -->
<button class="accordion phase-blue exportable">
  <span>‚û§</span> Introducci√≥n: ¬øQu√© es SAP FUE?
</button>

<div class="panel exportable-panel">
  <p class="pdf-block">
    <strong>SAP FUE (Full User Equivalent)</strong> es una m√©trica que ayuda a calcular la cantidad de licencias necesarias seg√∫n los usuarios de la empresa y su nivel de uso en el sistema.
  </p>
  
  <h3 class="pdf-block">Tipo de usuario (lenguaje negocio)</h3>
  <table class="pdf-block">
    <tr><th>Tipo de usuario</th><th>Ejemplo</th><th>FUE t√≠pico</th></tr>
    <tr><td>Usuario clave</td><td>Finanzas, planeaci√≥n, ventas</td><td>1.0</td></tr>
    <tr><td>Usuario operativo</td><td>Compras, almac√©n, log√≠stica</td><td>0.3‚Äì0.5</td></tr>
    <tr><td>Usuario ocasional</td><td>Aprobadores, gerentes</td><td>0.03</td></tr>
  </table>

  <h3 class="pdf-block">Paso 2Ô∏è‚É£ Usar n√∫meros reales (no %)</h3>
  <pre class="pdf-block">
Ejemplo:
50 usuarios clave
120 usuarios operativos
80 usuarios ocasionales
  </pre>

  <h3 class="pdf-block">Paso 3Ô∏è‚É£ Conversi√≥n directa a FUE</h3>
  <table class="pdf-block">
    <tr><th>Usuarios reales</th><th>Consumo</th></tr>
    <tr><td>50 usuarios clave √ó 1.0</td><td>50 FUE</td></tr>
    <tr><td>120 operativos √ó 0.3</td><td>36 FUE</td></tr>
    <tr><td>80 ocasionales √ó 0.03</td><td>2.4 FUE</td></tr>
    <tr><th>Consumo total aproximado</th><th>‚âà 38‚Äì40 FUEs</th></tr>
  </table>
</div>


<!-- Usuarios y c√°lculo de FUE -->
<button class="accordion phase-green">
  <span>‚û§</span> Usuarios y c√°lculo de FUE
</button>

<div class="panel">

  <!-- FINANZAS (FI / CO) -->
  <h4>Finanzas (FI / CO)</h4>
  <label>Gerente de Finanzas / Controller (Advanced Use):
    <input type="number" class="usuario-area" data-area="Finanzas" data-rol="Gerente Finanzas" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Analista Financiero / Costos (Core Use):
    <input type="number" class="usuario-area" data-area="Finanzas" data-rol="Analista Financiero" data-tipo="core" min="0" value="0">
  </label>
  <label>Auxiliar Contable (Core Use):
    <input type="number" class="usuario-area" data-area="Finanzas" data-rol="Auxiliar Contable" data-tipo="core" min="0" value="0">
  </label>

  <!-- COMPRAS / MM -->
  <h4>Compras / Gesti√≥n de Materiales (MM)</h4>
  <label>Gerente de Compras (Advanced Use):
    <input type="number" class="usuario-area" data-area="Compras" data-rol="Gerente Compras" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Comprador Operativo (Core Use):
    <input type="number" class="usuario-area" data-area="Compras" data-rol="Comprador" data-tipo="core" min="0" value="0">
  </label>
  <label>Solicitante / Almacenista (Self-Service Use):
    <input type="number" class="usuario-area" data-area="Compras" data-rol="Solicitante" data-tipo="self-service" min="0" value="0">
  </label>

  <!-- VENTAS / SD -->
  <h4>Ventas y Distribuci√≥n (SD)</h4>
  <label>Gerente Comercial / Ventas (Advanced Use):
    <input type="number" class="usuario-area" data-area="Ventas" data-rol="Gerente Ventas" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Ejecutivo de Ventas / Facturaci√≥n (Core Use):
    <input type="number" class="usuario-area" data-area="Ventas" data-rol="Ejecutivo Ventas" data-tipo="core" min="0" value="0">
  </label>
  <label>Consulta de pedidos / precios (Self-Service Use):
    <input type="number" class="usuario-area" data-area="Ventas" data-rol="Consulta Ventas" data-tipo="self-service" min="0" value="0">
  </label>

  <!-- PRODUCCI√ìN / PP -->
  <h4>Producci√≥n (PP)</h4>
  <label>Planeador de Producci√≥n (Advanced Use):
    <input type="number" class="usuario-area" data-area="Produccion" data-rol="Planeador Produccion" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Supervisor de Producci√≥n (Core Use):
    <input type="number" class="usuario-area" data-area="Produccion" data-rol="Supervisor Produccion" data-tipo="core" min="0" value="0">
  </label>
  <label>Operador / Confirmaci√≥n de √≥rdenes (Self-Service Use):
    <input type="number" class="usuario-area" data-area="Produccion" data-rol="Operador Produccion" data-tipo="self-service" min="0" value="0">
  </label>

  <!-- CALIDAD / QM -->
  <h4>Gesti√≥n de Calidad (QM)</h4>
  <label>Responsable de Calidad (Advanced Use):
    <input type="number" class="usuario-area" data-area="Calidad" data-rol="Responsable Calidad" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Inspector de Calidad (Core Use):
    <input type="number" class="usuario-area" data-area="Calidad" data-rol="Inspector Calidad" data-tipo="core" min="0" value="0">
  </label>

  <!-- MANTENIMIENTO / PM -->
  <h4>Mantenimiento de Planta (PM)</h4>
  <label>Jefe de Mantenimiento (Advanced Use):
    <input type="number" class="usuario-area" data-area="Mantenimiento" data-rol="Jefe Mantenimiento" data-tipo="advanced" min="0" value="0">
  </label>
  <label>T√©cnico de Mantenimiento (Core Use):
    <input type="number" class="usuario-area" data-area="Mantenimiento" data-rol="Tecnico Mantenimiento" data-tipo="core" min="0" value="0">
  </label>
  <label>Solicitud de avisos (Self-Service Use):
    <input type="number" class="usuario-area" data-area="Mantenimiento" data-rol="Avisos Mantenimiento" data-tipo="self-service" min="0" value="0">
  </label>

  <!-- PROYECTOS / PS -->
  <h4>Gesti√≥n de Proyectos (PS)</h4>
  <label>Gerente de Proyecto (Advanced Use):
    <input type="number" class="usuario-area" data-area="Proyectos" data-rol="Gerente Proyecto" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Control de Proyecto / Costos (Core Use):
    <input type="number" class="usuario-area" data-area="Proyectos" data-rol="Control Proyecto" data-tipo="core" min="0" value="0">
  </label>

  <!-- RECURSOS HUMANOS / HCM -->
  <h4>Recursos Humanos (HCM)</h4>
  <label>Responsable de RH (Advanced Use):
    <input type="number" class="usuario-area" data-area="RRHH" data-rol="Responsable RH" data-tipo="advanced" min="0" value="0">
  </label>
  <label>Administrador de Personal / N√≥mina (Core Use):
    <input type="number" class="usuario-area" data-area="RRHH" data-rol="Administrador RH" data-tipo="core" min="0" value="0">
  </label>
  <label>Empleado / Autoservicio (Self-Service Use):
    <input type="number" class="usuario-area" data-area="RRHH" data-rol="Empleado" data-tipo="self-service" min="0" value="0">
  </label>

  <!-- IT / SISTEMAS -->
  <h4>Sistemas / IT</h4>
  <label>Administrador SAP / IT (Advanced Use):
    <input type="number" class="usuario-area" data-area="IT" data-rol="Administrador SAP" data-tipo="advanced" min="0" value="0">
  </label>

  <!-- APROBADORES -->
  <h4>Direcci√≥n y Aprobadores</h4>
  <label>Director / Gerente General (Self-Service Use):
    <input type="number" class="usuario-area" data-area="Direccion" data-rol="Director General" data-tipo="self-service" min="0" value="0">
  </label>

</div>


<button id="calcular">Calcular FUE</button>
<button id="exportar">Exportar PDF</button>
<button id="guardarPDF">Guardar PDF Local</button>


<div id="resumen"></div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>

document.getElementById("guardarPDF").addEventListener("click", function() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ orientation: "p", unit: "pt", format: "a4" });

  // Abrir todos los acordeones antes de exportar
  const acordeones = document.querySelectorAll(".accordion");
  acordeones.forEach(acc => {
    acc.classList.add("active");
    const panel = acc.nextElementSibling;
    panel.style.display = "block";
  });

  const contenido = document.querySelector(".container"); // Toda la gu√≠a

  // Reemplazar checkboxes por s√≠mbolos visibles
  const checkboxes = contenido.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach(cb => {
    const symbol = cb.checked ? "‚úì" : "‚úó";
    const span = document.createElement("span");
    span.textContent = symbol;
    span.style.fontWeight = "bold";
    span.style.color = cb.checked ? "green" : "red";
    cb.parentNode.replaceChild(span, cb);
  });

  const pageWidth = doc.internal.pageSize.getWidth();
  const marginLeft = 15;
  const marginRight = 15;
  const headerHeight = 50;
  const bottomMargin = 30;

  doc.html(contenido, {
    x: marginLeft,
    y: headerHeight,
    html2canvas: { scale: 0.6, width: pageWidth - marginLeft - marginRight },
    callback: function(doc) {
      const totalPages = doc.internal.getNumberOfPages();
      for (let i = 1; i <= totalPages; i++) {
        doc.setPage(i);

        // Encabezado
        doc.setFont("helvetica", "bold");
        doc.setFontSize(18);
        doc.text("Gu√≠a de Preventa SAP - Alan Espinosa", pageWidth / 2, 25, { align: "center" });

        // Pie de p√°gina
        const footerY = doc.internal.pageSize.getHeight() - bottomMargin;
        doc.setFont("helvetica", "normal");
        doc.setFontSize(10);
        doc.text(`P√°gina ${i} de ${totalPages}`, pageWidth - marginRight - 100, footerY);
      }

      // Descarga directa
      const fecha = new Date().toISOString().slice(0,10);
      doc.save(`GuiaPreventaSAP_${fecha}.pdf`);
    },
    margin: [headerHeight, marginRight, bottomMargin, marginLeft]
  });
});


document.addEventListener("DOMContentLoaded", function() {
  // Inicializar fecha autom√°tica
  const fechaInput = document.getElementById("fecha");
  const hoy = new Date();
  fechaInput.value = hoy.toLocaleDateString();

  // Acordeones
  const acc = document.getElementsByClassName("accordion");
  for (let i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
      this.classList.toggle("active");
      const panel = this.nextElementSibling;
      panel.style.display = panel.style.display === "block" ? "none" : "block";
    });
  }

  const areas = [
  { nombre: "Finanzas", factor: 1.0 },
  { nombre: "Compras", factor: 1.0 },
  { nombre: "Ventas", factor: 1.0 },
  { nombre: "Produccion", factor: 1.0 },
  { nombre: "Calidad", factor: 1.0 },
  { nombre: "Mantenimiento", factor: 1.0 },
  { nombre: "Proyectos", factor: 1.0 },

  { nombre: "RRHH", factor: 0.3 },

  { nombre: "IT", factor: 1.0 },

  { nombre: "Direccion", factor: 0.03 }
];



  const opcionesSAP = [
  { nombre: "SAP Cloud ERP", fueMin: 1 },
  { nombre: "SAP Cloud ERP Private", fueMin: 1 }
];

  function calcularFUE() {
  let totalFUE = 0;
  const resumenDiv = document.getElementById("resumen");
  resumenDiv.innerHTML = "<h2>Detalle FUE por √Årea y Rol</h2>";

  // ---------------- DETALLE FUE ----------------
  let tabla = `<table border="1" cellspacing="0" cellpadding="4">
    <tr>
      <th>√Årea</th>
      <th>Rol</th>
      <th>Tipo Usuario</th>
      <th>Usuarios</th>
      <th>FUE Unitario</th>
      <th>Subtotal FUE</th>
    </tr>`;

  const inputs = document.querySelectorAll(".usuario-area");

  inputs.forEach(input => {
    const cantidad = parseFloat(input.value) || 0;
    const area = input.getAttribute("data-area") || "";
    const rol = input.getAttribute("data-rol") || "";
    const tipo = input.getAttribute("data-tipo") || "core";

    // Calcular FUE seg√∫n tipo
    let fueUnit = 0;
    switch(tipo) {
      case "advanced": fueUnit = 1; break;         // 1 FUE por Advanced
      case "core": fueUnit = 0.2; break;           // 0.2 FUE por Core
      case "self-service": fueUnit = 0.033; break; // 0.033 FUE por Self-Service
      case "developer": fueUnit = 0.5; break;      // 0.5 FUE por Dev (2 usuarios = 1 FUE)
      default: fueUnit = 0.2;
    }

    const subtotal = cantidad * fueUnit;
    totalFUE += subtotal;

    tabla += `
      <tr>
        <td>${area}</td>
        <td>${rol}</td>
        <td>${tipo}</td>
        <td>${cantidad}</td>
        <td>${fueUnit.toFixed(3)}</td>
        <td>${subtotal.toFixed(2)}</td>
      </tr>`;
  });

  tabla += `
    <tr>
      <th colspan="5">TOTAL FUE ESTIMADO</th>
      <th>${totalFUE.toFixed(2)}</th>
    </tr>
  </table>`;

  resumenDiv.innerHTML += tabla;

  // ---------------- OPCIONES SAP ----------------
  // Solo dos opciones de compra m√≠nima
  const opcionesSAP = [
    { nombre: "SAP Cloud ERP", fueMin: 25 },
    { nombre: "SAP Cloud ERP Private", fueMin: 1 }
  ];

  let opcionesCubridoras = opcionesSAP.filter(op => totalFUE >= op.fueMin);
  let mejorOpcion = null;
  if (opcionesCubridoras.length > 0) {
    mejorOpcion = opcionesCubridoras.reduce(
      (prev, curr) => curr.fueMin < prev.fueMin ? curr : prev
    );
  }

  let tablaSAP = `
    <h2>Opciones de Compra m√≠nima SAP</h2>
    <table border="1" cellspacing="0" cellpadding="4">
      <tr>
        <th>Opci√≥n</th>
        <th>FUE m√≠nimo</th>
        <th>Total FUE vs opci√≥n</th>
        <th>Sem√°foro</th>
      </tr>`;

  opcionesSAP.forEach(op => {
    const ratio = totalFUE / op.fueMin;
    let colorClass = "semaforo-verde";

    if (ratio < 1) colorClass = "semaforo-rojo";
    else if (ratio < 1.2) colorClass = "semaforo-amarillo";

    const semaforo = `<span class="semaforo ${colorClass}">‚óè</span>`;
    const barra = `
      <div class="barra-container" style="width:100px; background:#eee; height:8px; border-radius:4px;">
        <div class="bar" style="width:${Math.min(ratio,1)*100}%; background:${colorClass.includes('verde')?'green':colorClass.includes('amarillo')?'orange':'red'}; height:100%; border-radius:4px;"></div>
      </div>`;

    let etiquetaMejor = "";
    if (mejorOpcion && op.nombre === mejorOpcion.nombre) etiquetaMejor = " <strong>(Recomendada)</strong>";

    tablaSAP += `
      <tr>
        <td>${op.nombre}${etiquetaMejor}</td>
        <td>${op.fueMin} FUE's</td>
        <td>${totalFUE.toFixed(2)} ${barra}</td>
        <td style="text-align:center;">${semaforo}</td>
      </tr>`;
  });

  tablaSAP += "</table>";
  resumenDiv.innerHTML += tablaSAP;
}

  document.getElementById("calcular").addEventListener("click", calcularFUE);

  // Exportar toda la gu√≠a a PDF profesional con checkboxes visibles
document.getElementById("exportar").addEventListener("click", function() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ orientation: "p", unit: "pt", format: "a4" });

  // Abrir todos los acordeones antes de exportar
  const acordeones = document.querySelectorAll(".accordion");
  acordeones.forEach(acc => {
    acc.classList.add("active");
    const panel = acc.nextElementSibling;
    panel.style.display = "block";
  });

  const contenido = document.querySelector(".container"); // Toda la gu√≠a dentro del container
  if (!contenido.innerHTML.trim()) {
    alert("Genera primero el resumen");
    return;
  }

  const pageWidth = doc.internal.pageSize.getWidth();
  const marginLeft = 15;
  const marginRight = 15;
  const headerHeight = 50;
  const bottomMargin = 30;

  // Antes de renderizar con html2canvas, reemplazamos checkboxes por s√≠mbolos visibles
  const checkboxes = contenido.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach(cb => {
    const symbol = cb.checked ? "‚úì" : "‚úó";
    const span = document.createElement("span");
    span.textContent = symbol;
    span.style.fontWeight = "bold";
    span.style.color = cb.checked ? "green" : "red";
    cb.parentNode.replaceChild(span, cb);
  });

  doc.html(contenido, {
    x: marginLeft,
    y: headerHeight,
    html2canvas: { scale: 0.6, width: pageWidth - marginLeft - marginRight },
    callback: function(doc) {
      const totalPages = doc.internal.getNumberOfPages();
      for (let i = 1; i <= totalPages; i++) {
        doc.setPage(i);

        // ----- Encabezado -----
        doc.setFont("helvetica", "bold");
        doc.setFontSize(18);
        doc.text("Gu√≠a de Preventa SAP - Alan Espinosa", pageWidth / 2, 25, { align: "center" });

        // ----- Pie de p√°gina -----
        const footerY = doc.internal.pageSize.getHeight() - bottomMargin;
        doc.setFont("helvetica", "normal");
        doc.setFontSize(10);
        doc.text(`P√°gina ${i} de ${totalPages}`, pageWidth - marginRight - 100, footerY);
      }

      doc.save("Guia_Prepventa_SAP.pdf");
    },
    margin: [headerHeight, marginRight, bottomMargin, marginLeft]
  });
});
}); 
</script>

</body>
</html>
